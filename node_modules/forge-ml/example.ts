import Forge from "@forge-ml/client";

const keyGuard = () => {
  throw new Error("set FORGE_KEY in your .env");
};

const forgeKey = process.env.FORGE_KEY || keyGuard();

const forge = Forge({
  forgeKey: forgeKey,
});

export default forge;

forge.person.query("Who is Jake Zegil?")

// const data = (await forge.script.query("grab a bunch of random words from the internet, then write them to a temporary file, then join them together using a crazy delimiter, then write the result to stdout")) as { scripts: string[] };

// for (const line of data.scripts) {
//   console.log(line);
//   execSync(line, { stdio: 'inherit' });
// }

// const plant = "tomato"

// console.log(await forge.plant.query("Give me information about a " + plant))

// let context = {
//   prompt: "Write me a poem about a little boy who loves a tree.",
//   conditions: "After creating the poem, edit it. If the current action is 'revise', revise the poem. After revising, score the poem from 1-10. Be discriminatory. If the poem is not good enough, return 'revise'. If the poem is good enough, publish the poem.",
//   currentAction: "create",
//   revisions: [] as string[]
// }

// type Action = {
//   nextAction: string,
//   payload: string,
//   score: number
// }

// const initialAction = await forge.workflow_draft_action.query(JSON.stringify(context)) as Action;

// const poem = initialAction.payload;
// console.log(initialAction)

// fs.writeFileSync("poem.txt", initialAction.payload);

// let currentAction = initialAction.nextAction;

// while ( ["revise", "score"].includes(currentAction) ) {
//   const action = await forge.workflow_draft_action.query(JSON.stringify(context)) as Action;
//   console.log(action)
//   if (action.nextAction === "revise") {
//     console.log(action.payload)
//     context.revisions.push(action.payload)
//     fs.writeFileSync("poem.txt", action.payload);
//   }
//   if (action.nextAction === "score") {
//     console.log(action.score)
//   }
//   currentAction = action.nextAction;
// }

// console.log("editing complete")

// const store = {

// }

console.log(await forge.person.query(
  `
  <div class="mt2 relative">
      <div class="FijOrCPNJFFSdbwDwdmlnLlCApyKQUKMLuHyg
          ">
        <div class="mxErlDrbOuvdetRnrxZtgBxLStudGTiLwDlwQ">
          <span tabindex="-1" id="ember42" class="artdeco-hoverable-trigger artdeco-hoverable-trigger--content-placed-bottom artdeco-hoverable-trigger--is-hoverable ember-view">
            <a href="/in/jake-zegil/overlay/about-this-profile/" id="ember43" class="ember-view pKdbHDicQJnpZfLqKrmcbLMkJjlPxNVvquqrg" aria-label="Jake has verifications" aria-describedby="artdeco-hoverable-artdeco-gen-42">
              <h1 class="text-heading-xlarge inline t-24 v-align-middle break-words">Jake Zegil</h1>
                <svg role="none" aria-hidden="true" class="v-align-middle t-black--light" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" data-supported-dps="24x24" data-test-icon="verified-medium">
<!---->    
    <use href="#verified-medium" width="24" height="24"></use>
</svg>

<!---->            </a>
            <div id="artdeco-gen-42" class="ember-view"><div id="ember45" class="ember-view"></div></div>
          </span>
<!----><!----><!----><!---->        </div>
<!---->        <div class="text-body-medium break-words" data-generated-suggestion-target="urn:li:fsu_profileActionDelegate:917885354">
          Building Engineers in NYC üåÉ  Prev: Building Engineering Teams @ Tenet Energy ‚ö°Ô∏è Watch me write @ jakezegil.substack.com
        </div>
<!----><!----><!---->      </div>
        <ul class="uvdLyBHNKIXhuBvkKaneMoMiGZmAOHxIXHCs">
            <li class="DZuaIIBZvRxTxbCqrXjSYVnnjzMCHqZArk">
              <button class="EryEORAppZsfbOKIzGeDPdgUPLRMqjmY text-align-left" aria-label="Current company: Fractal Bootcamp. Click to skip to experience card" type="button">
                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="" id="ember76" class="evi-image ghost-company ember-view ODsLIIOglIiSAueKLVlueZLIdnyEOAPiPVPU EntityPhoto-square-1">
                <span class="kTPknTygTPMCzAEuhALCEmsMRpBLdSoE hoverable-link-text break-words text-body-small t-black">
                  
    <div class="dqkWaEeIodHKVPvyYIhFPTLEkeXNOYePSOhk
        inline-show-more-text--is-collapsed
        inline-show-more-text--is-collapsed-with-line-clamp
        
        
        " style="-webkit-line-clamp:2;" tabindex="-1">

        Fractal Bootcamp
      
<!---->    </div>
  
                </span>
              </button>
            </li>
<!---->        </ul>
      <div class="FijOrCPNJFFSdbwDwdmlnLlCApyKQUKMLuHyg mt2">
<!---->        <span class="text-body-small inline t-black--light break-words">
          New York, New York, United States
        </span>
          <span class="NHJktZHuzmXlxHKRKUZRHQRozXlBTLDGofpk t-black--light">
            <a href="/in/jake-zegil/overlay/contact-info/" id="top-card-text-details-contact-info" class="ember-view link-without-visited-state cursor-pointer text-heading-small inline-block break-words">
              Contact info
            </a>
          </span>
      </div>
    </div>
    <section class="artdeco-card pv-profile-card break-words
            
            
            
    mt2" tabindex="-1" data-view-name="profile-card">
<!---->

  <div id="about" class="pv-profile-card__anchor">
  </div>
<!---->            
  
<!---->
<div class="grmBZMrvDOfHOmMzdFrnECUbNFHKhqsUsdmEc">
<div class="pvs-header__top-container--no-stack">
<div class="pvs-header__left-container--stack">
  <div class="gjHqMPPxyxfMEApIkOGMVsgZtvtyTeMqfmI">
      <h2 class="pvs-header__title
          
          text-heading-large">
        <span aria-hidden="true"><!---->About<!----></span><span class="visually-hidden"><!---->About<!----></span>
      </h2>
<!----><!---->          </div>

<!---->        </div>

  <div class="pvs-header__right-container">
<!---->              
<div class="">
  
<div>

<a class="optional-action-target-wrapper artdeco-button artdeco-button--tertiary artdeco-button--standard artdeco-button--3 artdeco-button--muted artdeco-button--circle
    inline-flex justify-center align-self-flex-start button-placement-wrap
    
    " target="_self" aria-hidden="false" id="navigation-add-edit-deeplink-edit-about" href="https://www.linkedin.com/in/jake-zegil/add-edit/SUMMARY/?profileFormEntryPoint=PROFILE_SECTION&amp;trackingId=U61OnNhiSoO%2BoX767Ljv6w%3D%3D">
    <div class="pvs-navigation__icon">
      <svg role="img" aria-hidden="false" aria-label="Edit about" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" data-supported-dps="24x24" data-test-icon="edit-medium">
<!---->    
<use href="#edit-medium" width="24" height="24"></use>
</svg>

    </div>
<!----><!---->        </a>

</div>

</div>

  </div>
</div>
</div>


    
  
<div class="display-flex ph5 pv3">

<div class="
  display-flex full-width" data-generated-suggestion-target="urn:li:fsu_profileActionDelegate:1948716272">

  
<div class="UUxvQHuhcQoirYeuaACZmvJJQUJoTFzdwzGo
  full-width t-14 t-normal t-black display-flex align-items-center">

<div class="dqkWaEeIodHKVPvyYIhFPTLEkeXNOYePSOhk
inline-show-more-text--is-collapsed
inline-show-more-text--is-collapsed-with-line-clamp


 full-width" style="-webkit-line-clamp:4;" tabindex="-1">

<span aria-hidden="true"><!---->Tech Leader and Community Builder in NYC üèôÔ∏è | Founder &amp; Mentor | Hiring Expert | Software Advocate | Writer<!----><br><br><!---->If you're a founder or startup engineer in NYC, or you want to be, connect with me here or follow me on substack @ jakezegil.substack.com<!----></span><span class="visually-hidden"><!---->Tech Leader and Community Builder in NYC üèôÔ∏è | Founder &amp; Mentor | Hiring Expert | Software Advocate | Writer

If you're a founder or startup engineer in NYC, or you want to be, connect with me here or follow me on substack @ jakezegil.substack.com<!----></span>

  <span class="inline-show-more-text__link-container-collapsed">
<!---->            <button class="inline-show-more-text__button
        inline-show-more-text__button--light
        link" aria-expanded="false" role="button" type="button">
      ‚Ä¶see more
    </button>
  </span>

<!---->    </div>

</div>


</div>

</div>


    <div>
        
  
<div class="ILxSNgMKHYlnHEUYMZnvGBCiPccqyfcqxXHM">
<!----><!----><!---->    </div>


    </div>

</section>
  `
))