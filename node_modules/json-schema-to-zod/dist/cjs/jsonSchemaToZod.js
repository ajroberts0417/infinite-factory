"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.jsonSchemaToZod = void 0;
const parseSchema_js_1 = require("./parsers/parseSchema.js");
const jsonSchemaToZod = (schema, { module, name, type, noImport, ...rest } = {}) => {
    if (type && (!name || module !== "esm")) {
        throw new Error("Option `type` requires `name` to be set and `module` to be `esm`");
    }
    let result = (0, parseSchema_js_1.parseSchema)(schema, {
        module,
        name,
        path: [],
        seen: new Map(),
        ...rest,
    });
    if (module === "cjs") {
        result = `module.exports = ${name ? `{ ${JSON.stringify(name)}: ${result} }` : result}
`;
        if (!noImport) {
            result = `const { z } = require("zod")

${result}`;
        }
    }
    else if (module === "esm") {
        result = `export ${name ? `const ${name} =` : `default`} ${result}
`;
        if (!noImport) {
            result = `import { z } from "zod"

${result}`;
        }
    }
    else if (name) {
        result = `const ${name} = ${result}`;
    }
    if (type && name) {
        let typeName = typeof type === "string"
            ? type
            : `${name[0].toUpperCase()}${name.substring(1)}`;
        result += `export type ${typeName} = z.infer<typeof ${name}>
`;
    }
    return result;
};
exports.jsonSchemaToZod = jsonSchemaToZod;
